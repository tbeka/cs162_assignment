{% extends 'base.html' %}

{% block content %}
<div class="container">
    {% for list in lists %}
    <div class="box">
        <h2 class="title is-4">{{ list.title }}</h2>
        <ul>
            {% for item in list.items if item.parent_id is none %}
                {{ render_item(item) }}
            {% endfor %}
        </ul>
    </div>
    {% endfor %}
</div>

<script>
function toggleSubItems(itemId) {
    var element = document.getElementById('sub-items-' + itemId);
    if (element) {
        element.classList.toggle('is-hidden');
    }
}
</script>

{% endblock %}

{% macro render_item(item, level=0) %}
<li>
    {{ item.content }}
    <!-- Optionally, add buttons or links for editing/deleting the item here -->
    {% if item.children %}
    <a href="javascript:void(0);" onclick="toggleSubItems({{ item.id }})">Toggle Sub-Items</a>
    <ul id="sub-items-{{ item.id }}" class="{{ 'is-hidden' if level >= 1 }}">
        {% for sub_item in item.children %}
            {{ render_item(sub_item, level + 1) }}
        {% endfor %}
    </ul>
    {% endif %}
</li>
{% endmacro %}
